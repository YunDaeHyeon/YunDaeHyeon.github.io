---
layout: post
title:  "[Network] OSI 7계층 분석"
date:   2022-03-20 18:39:00+0900
categories: jekyll update
tags: [Network]
---
# OSI 7계층이란?
 - Open Systems Interconnection (개방형 시스템 상호연결)의 약자로, 네트워크에서 통신이 일어나는 과정을 7계층으로 나눈 모델.  

# 네트워크란?
- 하드웨어끼리 마치 그물망처럼 연결되어 데이터들을 주고받는 집단  
- 네트워크는 일대일 커뮤니케이션에서 원거리 커뮤니케이션의 필요성으로 발달하게 되었음.  
- 기술의 발달로 기존 아날로그 신호가 아닌 전기적 신호를 활용하게 되면서 마치 여러 대의 기기가 그물망처럼 연결되어 서로 통신한다는 뜻의 네트워크 구축을 가속화 시킴. 이러한 과정에서 1970 ~ 1980년대 말까지 많은 대학과 연구가들은 서로 다른 네트워크들을 연결시키려고 노력함.  
  
<p align="center"><img src="/assets/img/blog/정보/네트워크 2.png"></p>
  
즉, OSI 7계층은 **네트워크를 구축할 때 이것을 참조해서 만들어라.** 라는 참조모델이다.
이때, ***OSI 7계층에서 각 계층은 독립적이나 상하구조 체계이기에 계층이 정상적으로 동작하기 위해서는 위, 아래 계층들이 정상적으로 동작되어야 한다.***  

# 계층 설명
## 1계층 (L1, Physical Layer, 물리 계층)
컴퓨터는 1과 9의 신호로 데이터를 정의한다. 하지만, 이런 형태의 전자기파는 항상 0과 무한대, 0과 무한대의 주파수 범위를 가진다. 따라서 이러한 전기적 신호를 통과할 수 있는 전선은 **없다.** 따라서 곡선 형태의 아날로그 신호로 변경해야 한다.  
**즉, 최소 두 대의 컴퓨터가 통신하기 위해 0과 1의 나열을 아날로그 신호로 바꾸어 전선으로 흘려 보내고, 아날로그 신호를 0, 1의 나열로 해석하는 역할을 하는 것이 L1의 역할이다.**  
이때, L1의 미디어 타입은 유선으로는 구리, 광섬유 등이 있고 무선으로는 공기가 있다.  
즉, L1에서는 전기적 신호를 이용하여 통신 케이블로 데이터를 전송하게 된다. 해당 계층에서 사용되는 통신 단위는 Bit이며 이것은 1과 0으로 나타내어지는, 즉 전기적으로 On, Off 상태를 표현한다.  
**L1의 장비로는 케이블, 리피터, 허브 등이 있다.**  

## 2계층 (L2, Data Link Layer, 데이터 링크 계층)
L2는 **직접 연결된 이웃 컴퓨터와의 통신만을 다룬다.**  
해당 계층에서 전송되는 데이터의 단위는 `프레임`이다. 직접 연결된 컴퓨터와의 통신만을 다루므로, **이웃 컴퓨터를 넘어가는 통신은 L2에서 관여하지 않는다.**  
또한 L2는 통신에 오류가 없도록 **다양한 역할들을 수행한다.**  
1. 프레이밍 : L1을 통해 받은 신호를 조합해 프레임 단위의 데이터 유닛으로 만들어 처리한다.
2. 흐름제어 : 데이터를 송수신 시, 너무 많거나 너무 적은 데이터를 송수신하지 않도록 흐름제어를 진행한다.  
3. 오류제어 : 프레임 전송 시 발생한 오류를 복원하거나 재전송 한다.  
4. 접근제어 : 매체 상 통신 주체(장치)가 여러 개 존재할 시, 데이터 전송 여부를 결정한다.  
5. 동기화 : 프레임 구분자를 나타낸다. (특별한 Bit 패턴)  
이처럼 L2은 단순히 데이터를 마구잡이로 보내지 않고 안전하게 보내는 역할도 수행한다.
L2은 직접적으로 연결된 두 개의 노드 사이에 데이터 전송을 가능하게 하고, L1에서 발생한 오류를 수정하기도 한다. L2에서 전송되는 데이터 단위는 프레임이라 부르며 L2의 장비로는 브릿지, 스위치 등이 있다. **또, L2에는 2개의 부계층이 존재하는데, 하나는 매체 접근 제어(MAC) 계층이며 다른 하나는 논리적 연결 제어(LLC) 계층이다. 네트워킹 세계에서 대부분 스위치는 L2에서 작동한다**

## 3계층 (L3, Network Layer, 네트워크 계층)
L3은 **전송할 데이터를 여러 개의 경로를 거쳐 목적지에 전송하는 계층이다.**
L3에서 전송단위는 `패킷`이라 부른다. 즉, 주소(IP)를 정하고 경로를 선택하고, `패킷`을 전달하는 것이 L3에서 이루어지며 이것을 `라우`팅이라 한다. (Port) `라우팅`은 네트워크에서 `패킷`을 보낼 때 목적지까지 갈 수 있는 여러 경로 중 한 경로를 설정해주는 과정이다. 또한 네트워크에서 패킷(데이터 전송 단위)을 보낼 때 목적지까지 갈 수 있는 여러 경로 중 한 경로를 설정해주는 과정으로, **L3에서 대부분의 라우팅이 작동한다. 3계층의 장비로는 라우터, L3 스위치 등이 있다.**

## 4계층 (L4, Transport Layer, 전송 계층)
L4에서는 **사용자들이 신뢰성 있는 데이터를 받을 수 있도록 전송 속도를 조정하거나, 오류가 발생하면 맞춰주는 역할을 수행한다.**  
***L4에서 사용되는 대표적인 프로토콜은 `TCP 프로토콜`과 `UDP 프로토콜`이 존재한다.***  
- TCP 프로토콜 : **신뢰성 있는 통신을 보장**하고 신뢰성 있는 연결과 전달을 보장하는 만큼 계속해서 연결을 유지해야하기에 그만큼 리소스가 더 들어간다.  
- UDP 프로토콜 : **UDP 프로토콜은 빠른 데이터 전송에 초점을 둔다. 목적지에 데이터가 제대로 도착했는지는 상관하지 않으며** 신뢰성 있는 데이터 전송보다 스트리밍과 같은 연속적인 특성을 가진 서비스에 UDP 프로토콜이 적합하다고 할 수 있다.  
정리하자면, L4에서는 보내고자 하는 데이터의 용량과, 속도, 목적지를 처리하며 주로 이용되는 것은 TCP와 UDP 프로토콜이다. **L4의 장비로는 L4 스위치가 있으며 L3과의 차이는 L3에서 온 트래픽을 분석해 서비스 종류를 구분한다.**
  
***!! L1부터 L4까지의 주된 기능은 데이터를 전달하는 것이다. L5부터는 데이터를 송/수신하는 양쪽 종점 컴퓨터내의 프로세스들 간의 통신 프로토콜이라고 할 수 있다.***
  
## 5계층 (L5, Session Layer, 세션 계층)

### 세션(Session)이란?
1. 네트워크 환경에서 사용자 간 또는 컴퓨터 간의 대화를 위한 논리적 연결  
    > 물리적 연결 : 케이블을 통해 직접 연결되는 통신  
    > 논리적 연결 : 물리적 연결 외의 IP(논리주소), MAC Address(물리주소) 등을 통해 통신  
2. 프로세스들 사이에 통신을 수행하기 위해 메세지 교환을 통해 서로 인식 한 이후부터 통신을 마칠 때까지의 기간  
  
즉, L5에서는 응용 프로그램 간의 통신을 하기 위한 **세션을 운영체재를 통해 확립, 유지, 중단하는 작업을 수행**한다. 응용 프로그램들 간의 접속을 설정, 유지하고 끊어질 경우 데이터를 재전송하거나 연결을 복구한다.  
L5에서 중요한 기능에는 `동기화`가 있다. 동기란, 통신 양단에서 서로 동의하는 논리적인 공통처리 지점으로써, **동기점을 설정하기 위해 사용된다. 동기점이 설정된다는 의미는 그 이전까지 통신은 서로 완벽하게 처리했다는 것을 뜻한다. 이를 통해 송수신 중 오류가 발생하면, 처음부터가 아닌 동기화 이후부터 다시 재전송한다.**
  
*! L5 역할 요약 !*  
- 사용자 위주의 논리적인 연결 서비스 제공  
- 전송모드 설정 (반이중, 전이중, 단방향, 병렬, 직렬, 동기, 비동기)  
- 대화와 동기를 위한 데이터 교환 관리  
- 토큰 (Token : 특정 서비스 요구 권리)  

## 6계층 (L6, Presentation Layer, 표현 계층)
L6은 L7에서 넘겨받은 데이터를 L5가 다룰 수 있는 데이터로 바꾸거나, L5에서 넘겨받은 데이터를 L7가 이해할 수 있는 형태로 바꾸고 전달한다. **이러한 데이터를 안전하게 사용하기 위하여 암호화 / 복호화도 진행한다.**  
즉, **사용자들이 상위나 하위계층에서 사용하는 데이터 표현 앙식과 무관하게 사용할 수 있도록 해주는 환경을 제공한다.**
  
예시 : EBCDIC로 인코딩된 문서 파일을 ASCII로 인코딩된 파일로 바꿔주기, 해당 데이터가 text인지, 그림인지, gif인지, jpg인지 구분해주기  

## 7계층 (L7, Application Layer, 응용 계층)
**L7은 사용자와 가장 가까운 층으로 응용 프로세스(크롬이란 웹 클라이언트에 접속하여)와 직접 관계해 일반적인 응용 서비스(HTTP 프로토콜 등)를 수행한다.**  
L7은 전송된 메일, 사진, 동영상 등이 크롬이나 사파리 등의 응용 프로그램을 통해 사용자가
눈으로 확인할 수 있는 과정이며, 이 데이터들은 해당되는 프로토콜(HTTP, FTP, SMTP 등)에 의해
처리된다.  
이때, `HTTP`라는 L7의 프로토콜은 응용 프로그램인 웹이나 브라우저에 필요한 데이터를 송수신할 때 사용되며, `FTP`는 파일 전송 프로토콜로 서버와 클라이언트 사이의 파일을 주고받을 때 사용한다.

# 데이터 캡슐화
데이터를 전송할 때는 L7 -> L1으로 간다. 이 과정에서 `캡슐화(encapsulation)`를 하게 되는데 각 계층은 다른 계층과 통신할 때 데이터에 특정 정보가 들어있는 **Header와 Footer**를 추가한 후 다른 계층으로 전달한다.  

<p align="center"><img src="/assets/img/blog/정보/네트워크 3.png"></p>

`PDU(Protocol Data Unit)`은 프로토콜 데이터 단위이며 OSI 모델의 정보 처리 단위이다. 
(L2의 데이터 PDU는 프레임.) **아래 계층으로 내려갈수록 PDU에는 다양한 프로토콜에 의해 Header와 Footer가 더해진다. 반대로, 데이터를 받은 컴퓨터가 PDU로부터 프로토콜의 Header와 Footer를 분석하여 올라가 마지막 L7에 도달하면 원본 데이터만 남는다.** `(디캡슐화, Decapsulation)`  

# OSI 7계층의 흐름 예시
**이메일을 보내는 과정**  

1. 작성된 메시지는 `L7`에서 `L6`으로 전달하게 된다.  
2. `L6`에서는 전달된 메시지를 데이터로 변환하거나, 암호화 또는 압축을 수행한다. 이렇게 변환된 데이터는 `L5`으로 전달되게 된다.  
3. `L5`으로 전달된 데이터는 동기화를 위하여 주기적으로 동기점(Sync)을 삽입하며 `L4`으로 데이터를 전달하게 된다.  
4. `L4`에서는 발신지와 목적지를 정하고 연결 방식을 연결성, 비연결성 방식으로 설정하여, 흐름 제어와 오류 제어 기능을 수행한다. 데이터 단위를 Segment, Datagram으로 나누며 만약에 악성코드가 있을 경우 방화벽이 작동을 해서 걸러준다.  
5. `L3`에서 라우팅에 필요한 논리 주소를 설정하고, 패킷에 대한 라우팅 정보를 삽입한다.  
6. `L2`에는 우선 프레임 단위로 데이터를 나눈다. 그리고 물리적 MAC 주소로 지정을 하고 속도 차이를 원활히 메꾸기 위해 흐름 제어를 수행한다.  
7. `L1`에는 전송 매체가 일반 케이블인지, 광케이블인지 매체의 길이를 설정하며 데이터를 회선으로 보내기 위해 전기적인 변환을 담당한다.  

# 암기 팁
- 응용 계층에서 물리 계층까지(위에서 아래로) (A-P-S-T-N-D-P)  
- 모든 사람은 데이터 처리가 필요한 듯 하다(All-People-Seem-To-Need-Data-Processing)  
- 물리 계층에서 응용 계층까지(아래에서 위로): (P-D-N-T-S-P-A)  
- 소시지 피자를 버리지 말아 주세요(Please-Do-Not-Throw-Sausage-Pizza-Away)  
  
  
  
  
---  
[리소스 및 참고 사이트]  
[noopy](https://velog.io/@jeongs/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-OSI-7-%EA%B3%84%EC%B8%B5-%EA%B7%B8%EB%A6%BC%EA%B3%BC-%ED%95%A8%EA%BB%98-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0)  
[네트워크 기초 – OSI 7계층과 TCP/IP 계층](https://snyung.com/content/2020-08-31--%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EA%B8%B0%EC%B4%88-OSI-7-%EA%B3%84%EC%B8%B5%EA%B3%BC-TCP-IP-%EA%B3%84%EC%B8%B5)  
[OSI 7계층이란?, OSI 7계층을 나눈 이유](https://shlee0882.tistory.com/110)  
[한국표준협회 KSA](https://www.ksa.or.kr/ksa_kr/942/subview.do)  
[히히의 OSI & Layer](https://www.youtube.com/watch?v=1pfTxp25MA8&t=1905s)  
[OSI](http://www.incodom.kr/OSI#h_d60201395b45707f84e7e65464da075f)  
[위키피디아](https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%EB%84%B7_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C_%EC%8A%A4%EC%9C%84%ED%8A%B8)  
[Keith Shaw](https://www.itworld.co.kr/news/135430)  

